{{ partial "header.html" . }}

<h2>Constellation Architecture</h2>

<br>

<section id="architecture">
  <div class="zoom-container">
    <img src="{{ .Site.BaseURL }}images/architecture.png" alt="Architecture Diagram" class="zoomable-image">
  </div>
</section>

<!-- Modal for clicking on the image -->
<div id="image-modal" class="modal">
  <span class="close">&times;</span>
  <img class="modal-content" id="modal-image">
</div>

<h2>Characteristics</h2>

<br>

<section id="table-responsive">
  {{ partial "characteristics-table.html" . }}
</section>

<h2>DT Live Embed</h2>

<br>

<script>
    async function fetchDataAndSend() {
        try {
            const res = await fetch('/data_dump.yaml');
            const text = await res.text();
            console.log('Fetched YAML data:', text.substring(0, 100) + '...');
            
            // Get the iframe and send message to it
            const iframe = document.getElementById('godot-iframe');
            if (iframe && iframe.contentWindow) {
                iframe.contentWindow.postMessage({toGodot: text}, '*');
                console.log('Message sent to Godot iframe');
            } else {
                console.error('Iframe not found or not ready');
            }
        } catch (error) {
            console.error('Error fetching or sending data:', error);
        }
    }
    
    // Wait for iframe to load before sending data
    window.addEventListener('load', () => {
        setTimeout(fetchDataAndSend, 1000); // Give iframe time to initialize
    });
</script>

<iframe 
    id="godot-iframe"
    src="{{ .Site.BaseURL }}DTInsight_web_export/DTInsight.html" 
    width="100%" 
    height="600" 
    style="border:none;">
</iframe>

<section id="content">
  <ul class="posts_listing">
    {{ range .Site.RegularPages }}
      <li>
        <h2><a href="{{ .Permalink }}">{{ .Title }}</a></h2>
        <div class="date">
          {{if not .Date.IsZero }}
            {{ .Date.Format (.Site.Params.dateform | default "January 2006") }}
          {{end}}
        </div>
      </li>
    {{ end }}
  </ul>
</section>

{{ partial "footer.html" . }}

